<clr-main-container>

    <fema-cms-header></fema-cms-header>

    <div class="content-container">

        <fema-cms-nav></fema-cms-nav>

        <main class="content-area"
              #clrContentArea>

            <h1>Edit Content: {{contentForm?.get('title')?.value}}</h1>

            <fema-cms-alert-on-action [errorOnInit]="errorOnInit"
                                      [responseOnAction]="responseOnAction"
                                      [isLoading]="!contentLookup && !formOptions && !resourcesPath && !content && !errorOnInit"
                                      [isFailed]="errorOnInit"
                                      (retry)="initialSetup()"
                                      (close)="responseOnAction = $event"></fema-cms-alert-on-action>

            <form *ngIf="contentLookup && formOptions && resourcesPath && content && !errorOnInit"
                  [formGroup]="contentForm"
                  (ngSubmit)="checkFormValidity($event)">

                <section class="form-block">

                    <label>Title</label>

                    <div class="form-group">

                        <label class="required">Content Title</label>

                        <label for="title"
                               aria-haspopup="true"
                               role="tooltip"
                               class="tooltip tooltip-validation tooltip-md"
                               [class.invalid]="invalidField('title')">

                            <input type="text"
                                   id="title"
                                   placeholder="Content title"
                                   maxlength="150"
                                   formControlName="title"
                                   size="70"/>

                            <span class="tooltip-content"
                                  *ngIf="invalidField('title', 'required')">
                                Title must be filled
                            </span>

                            <span class="tooltip-content"
                                  *ngIf="invalidField('title', 'unique')">
                                Title must be unique
                            </span>

                        </label>

                    </div>

                </section>

                <hr/>

                <section class="form-block"
                         formGroupName="newsDto">

                    <label>

                        <clr-checkbox [formControlName]="'selected'"
                                      [clrDisabled]="newsForm?.get('selected')?.disabled">
                            News/Info
                        </clr-checkbox>

                    </label>

                    <div class="form-group">

                        <label class="required">News/Info Category</label>

                        <label for="newsCategorySelect"
                               aria-haspopup="true"
                               role="tooltip"
                               class="tooltip tooltip-validation tooltip-md"
                               [class.invalid]="invalidField(['newsDto', 'idNewsCategory'])">

                            <span class="select">

                                <select id="newsCategorySelect"
                                        [formControlName]="'idNewsCategory'">

                                    <option *ngFor="let cat of formOptions?.newsCategories"
                                            [value]="cat?.id">
                                        {{cat?.meaning}}
                                    </option>

                                </select>

                            </span>

                            <span class="tooltip-content tooltip-content--show"
                                  style="margin-left:1.5cm"
                                  *ngIf="invalidField(['newsDto', 'idNewsCategory'], 'required')">
                                News/Info Category must be selected
                            </span>

                        </label>

                    </div>

                    <div class="form-group">

                        <label class="required">Content Message</label>

                        <div style="max-width: 1205px; width: 90%;">

                            <label style="width: 100%; height: 50vh;"
                                   aria-haspopup="true"
                                   role="tooltip"
                                   class="tooltip tooltip-validation tooltip-md"
                                   [class.invalid]="invalidField(['newsDto', 'content'])">

                                <fema-cms-quill [imgFolder]="resourcesPath?.news?.folder"
                                                [initialContent]="newsHtmlContent"
                                                [enabled]="newsForm?.get('selected')?.value"
                                                (content)="getContentNews($event)"></fema-cms-quill>

                                <span class="tooltip-content tooltip-content--show"
                                      style="margin-left:8cm"
                                      *ngIf="invalidField(['newsDto', 'content'], 'required')">
                                    Content Message must be filled
                                </span>

                            </label>

                        </div>

                    </div>

                </section>


                <hr/>

                <section class="form-block"
                         formGroupName="bannerDto">

                    <label>

                        <clr-checkbox [formControlName]="'selected'"
                                      [clrDisabled]="bannerForm?.get('selected')?.disabled">
                            Banner
                        </clr-checkbox>

                    </label>

                    <div class="row">

                        <div class="col-xl-8 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <span class="label label-info">
                                <i>Note: Use *.jpg and *.png with max. file size of {{+contentLookup?.maxBannerSize / 1000}} MB</i>
                            </span>

                            <div class="form-group">

                                <label class="required">Upload Banner</label>

                                <label for="bannerImgFile"
                                       aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['bannerDto', 'imgFile'])"
                                       style="height: fit-content">

                                    <ng-template [ngIf]="bannerForm?.get('imgLocation')?.value">

                                        <span class="label label-info">
                                            <i>Existing banner: {{bannerForm?.get('imgLocation')?.value | fileName}}</i>
                                        </span>

                                        <br/>

                                    </ng-template>

                                    <input type="file"
                                           id="bannerImgFile"
                                           multiple="multiple"
                                           size="50"
                                           accept="image/png, image/jpeg"
                                           (change)="selectBannerImage($event)"
                                           [disabled]="!bannerForm?.get('selected')?.value"/>

                                    <span class="tooltip-content tooltip-content--show"
                                          *ngIf="invalidField(['bannerDto', 'imgFile'], 'maxFileSize')">
                                        Maximum size allowed is {{+showError(['bannerDto', 'imgFile'], 'maxFileSize')['maxFileSize'] / 1000}} MB
                                    </span>

                                    <span class="tooltip-content tooltip-content--show"
                                          *ngIf="invalidField(['bannerDto', 'imgFile'], 'fileTypes')">
                                        Format file invalid
                                    </span>

                                    <span class="tooltip-content"
                                          *ngIf="invalidField(['bannerDto', 'imgFile'], 'required')">
                                        Banner must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                        <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label class="required">Active</label>

                                <div class="toggle-switch">

                                    <input type="checkbox"
                                           id="bannerActiveToggle"
                                           formControlName="active"/>

                                    <label for="bannerActiveToggle">
                                        {{bannerForm?.get('active')?.value ? 'Yes' : 'No'}}
                                    </label>

                                </div>

                            </div>

                            <div class="form-group">

                                <label>Set as Default Banner</label>

                                <div class="toggle-switch">

                                    <input type="checkbox"
                                           id="defaultBannerToggle"
                                           (click)="defaultBannerSubject.next($event)"
                                           formControlName="defaultBanner"/>

                                    <label for="defaultBannerToggle">
                                        {{bannerForm?.get('defaultBanner')?.value ? 'Yes' : 'No'}}
                                    </label>

                                </div>

                            </div>

                        </div>

                    </div>

                    <div class="form-group">

                        <label class="required">Description</label>

                        <label for="bannerDescription"
                               aria-haspopup="true"
                               role="tooltip"
                               class="tooltip tooltip-validation tooltip-md"
                               [class.invalid]="invalidField(['bannerDto', 'description'])"
                               style="width: 100%">

                            <textarea
                                id="bannerDescription"
                                placeholder="Description"
                                rows="3"
                                formControlName="description"
                                [maxlength]="contentLookup?.maxBannerDesc"></textarea>

                            <span class="tooltip-content tooltip-content--show"
                                  style="margin-left:1.5cm"
                                  *ngIf="invalidField(['bannerDto', 'description'], 'required')">
                                Description must be filled
                            </span>

                        </label>

                    </div>

                    <br/><br/><br/>

                    <div class="row">

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label class="required">Banner Period Start</label>

                                <label aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['bannerDto', 'periodStart'])">

                                    <input type="text"
                                           (click)="uiState.bannerPeriodStartIsOpen = true"
                                           [matDatepicker]="domBannerPeriodStart"
                                           [min]="currentDate | date:'yyyy-MM-dd'"
                                           [max]="bannerForm?.get('periodEnd')?.value"
                                           onkeydown="return false"
                                           placeholder="DD-MMM-YYYY"
                                           formControlName="periodStart"/>

                                    <button type="button"
                                            class="btn btn-icon btn-link"
                                            *ngIf="!!bannerForm?.get('periodStart')?.value && bannerForm?.get('periodStart')?.enabled"
                                            (click)="resetBannerCalendar('periodStart')">

                                        <clr-icon shape="times"></clr-icon>

                                    </button>

                                    <mat-datepicker #domBannerPeriodStart
                                                    [opened]="uiState?.bannerPeriodStartIsOpen"
                                                    (closed)="uiState.bannerPeriodStartIsOpen = false"
                                                    disabled="false"></mat-datepicker>

                                    <span class="tooltip-content tooltip-content--show"
                                          style="margin-left:1.5cm"
                                          *ngIf="invalidField(['bannerDto', 'periodStart'], 'required')">
                                        Banner Period Start must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label class="required">Banner Period End</label>

                                <label aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['bannerDto', 'periodEnd'])">

                                    <input type="text"
                                           (click)="uiState.bannerPeriodEndIsOpen = true"
                                           [matDatepicker]="domBannerPeriodEnd"
                                           [min]="bannerForm?.getRawValue()?.periodStart"
                                           onkeydown="return false"
                                           placeholder="DD-MMM-YYYY"
                                           formControlName="periodEnd"/>

                                    <button type="button"
                                            class="btn btn-icon btn-link"
                                            *ngIf="!!bannerForm?.get('periodEnd')?.value && bannerForm?.get('periodEnd')?.enabled"
                                            (click)="resetBannerCalendar('periodEnd')">

                                        <clr-icon shape="times"></clr-icon>

                                    </button>

                                    <mat-datepicker #domBannerPeriodEnd
                                                    [opened]="uiState?.bannerPeriodEndIsOpen"
                                                    (closed)="uiState.bannerPeriodEndIsOpen = false"
                                                    disabled="false">
                                    </mat-datepicker>

                                    <span class="tooltip-content tooltip-content--show"
                                          style="margin-left:1.5cm"
                                          *ngIf="invalidField(['bannerDto', 'periodEnd'], 'required')">
                                        Banner Period End must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label [class.required]="bannerForm?.get('idLinkedMenu')?.validator">
                                    Linked to Menu
                                </label>

                                <label for="bannerIdLinkedMenu"
                                       aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['bannerDto', 'idLinkedMenu'])">

                                    <span class="select">

                                        <select id="bannerIdLinkedMenu"
                                                [formControlName]="'idLinkedMenu'">

                                            <option *ngFor="let link of formOptions?.linkMenu"
                                                    [value]="link?.id">
                                                {{link?.detailCode | titlecase}}
                                            </option>

                                        </select>

                                    </span>

                                    <span class="tooltip-content"
                                          *ngIf="invalidField(['bannerDto', 'idLinkedMenu'], 'required')">
                                        Linked to Menu must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label for="titleField"
                                       [class.required]="bannerForm?.get('title')?.validator">Title</label>

                                <label for="titleField"
                                       aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['bannerDto', 'title'])">

                                    <input type="text"
                                           size="55"
                                           id="titleField"
                                           placeholder="Title"
                                           [attr.list]="bannerTitleDatalist"
                                           formControlName="title"
                                           (blur)="checkBannerTemplate($event)"/>

                                    <span class="tooltip-content"
                                          *ngIf="invalidField(['bannerDto', 'title'], 'required')">
                                        Title must be filled
                                    </span>

                                    <datalist id="bannerTitleSelection">

                                        <option *ngFor="let title of suggestions?.bannerTitles; trackBy: ngForTracker"
                                                [value]="title?.title || title['templateName']">
                                            {{title?.title || title['templateName']}}
                                        </option>

                                    </datalist>

                                </label>

                            </div>

                        </div>

                    </div>

                    <clr-modal [clrModalOpen]="uiState?.bannerDefaultModalIsOpen"
                               [clrModalClosable]="false">

                        <h3 class="modal-title">Set as Default</h3>

                        <div class="modal-body">

                            <p>This will override existing default banner. Continue?</p>

                        </div>

                        <div class="modal-footer">

                            <button type="button"
                                    class="btn btn-outline"
                                    (click)="removeDefaultBanner($event)">
                                Cancel
                            </button>

                            <button type="button"
                                    class="btn btn-primary"
                                    (click)="setAsDefaultBanner($event)">
                                Set Default
                            </button>

                        </div>

                    </clr-modal>

                </section>

                <hr/>

                <section class="form-block"
                         formGroupName="popupDto">

                    <label>

                        <clr-checkbox
                            [formControlName]="'selected'"
                            [clrDisabled]="popupForm?.get('selected')?.disabled">
                            Popup Notification Setup
                        </clr-checkbox>

                    </label>

                    <div class="row">

                        <div class="col-xl-8 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <span class="label label-info">
                                <i>Note: Use *.jpg and *.png with max. file size of {{+contentLookup?.maxPopupSize / 1000}} MB</i>
                            </span>

                            <div class="form-group">

                                <label class="required">Upload Image</label>

                                <label for="popupImgFile"
                                       aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['popupDto', 'imgFile'])"
                                       style="height: fit-content;">

                                    <ng-template [ngIf]="popupForm?.get('imgLocation')?.value">

                                        <span class="label label-info"
                                              *ngIf="popupForm?.get('selected')?.value">
                                            <i>Existing popup: {{popupForm?.get('imgLocation')?.value | fileName}}</i>
                                        </span>

                                        <br/>

                                    </ng-template>

                                    <input type="file"
                                           id="popupImgFile"
                                           multiple="multiple"
                                           accept="image/png, image/jpeg"
                                           (change)="selectPopupImage($event)"
                                           [disabled]="!popupForm?.get('selected')?.value"/>

                                    <span
                                        class="tooltip-content tooltip-content--show"
                                        *ngIf="invalidField(['popupDto', 'imgFile'], 'maxFileSize')">
                                        Maximum size allowed is {{+showError(['popupDto', 'imgFile'], 'maxFileSize')['maxFileSize'] / 1000}} MB
                                    </span>

                                    <span
                                        class="tooltip-content tooltip-content--show"
                                        *ngIf="invalidField(['popupDto', 'imgFile'], 'fileTypes')">
                                        Format file invalid
                                    </span>

                                    <span *ngIf="invalidField(['popupDto', 'imgFile'], 'required')"
                                          class="tooltip-content tooltip-content--show">
                                        Popup must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                        <div class="col-xl-4 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label class="required">Active</label>

                                <div class="toggle-switch">

                                    <input type="checkbox"
                                           id="popupActiveToggle"
                                           formControlName="active"/>
                                    <label for="popupActiveToggle">
                                        {{popupForm?.get('active')?.value ? 'Yes' : 'No'}}
                                    </label>

                                </div>

                            </div>

                        </div>

                    </div>

                    <div class="form-group">

                        <label class="required">Description</label>

                        <label
                            for="descriptionField"
                            aria-haspopup="true"
                            role="tooltip"
                            class="tooltip tooltip-validation tooltip-md"
                            [class.invalid]="invalidField(['popupDto', 'description'])"
                            style="width: 100%">

                            <textarea
                                id="descriptionField"
                                placeholder="Description"
                                rows="3"
                                formControlName="description"
                                [maxlength]="contentLookup?.maxPopupDesc"></textarea>

                            <span
                                class="tooltip-content tooltip-content--show"
                                style="margin-left:1.5cm"
                                *ngIf="invalidField(['popupDto', 'description'], 'required')">
                                Description must be filled
                            </span>

                        </label>

                    </div>

                    <br/><br/><br/>

                    <div class="row">

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label class="required">Notification Period Start</label>

                                <label
                                    for="periodStart"
                                    aria-haspopup="true"
                                    role="tooltip"
                                    class="tooltip tooltip-validation tooltip-md"
                                    [class.invalid]="invalidField(['popupDto', 'periodStart'])">

                                    <input
                                        id="periodStart"
                                        type="text"
                                        (click)="uiState.popupPeriodStartIsOpen = true"
                                        [matDatepicker]="domPopupPeriodStart"
                                        [max]="popupForm?.get('periodEnd')?.value"
                                        onkeydown="return false"
                                        placeholder="DD-MMM-YYYY"
                                        [min]="currentDate"
                                        formControlName="periodStart"/>

                                    <button type="button"
                                            class="btn btn-icon btn-link"
                                            *ngIf="!!popupForm?.get('periodStart')?.value && popupForm?.get('periodStart')?.enabled"
                                            (click)="resetPopupCalendar('periodStart')">

                                        <clr-icon shape="times"></clr-icon>

                                    </button>

                                    <mat-datepicker
                                        #domPopupPeriodStart
                                        [opened]="uiState?.popupPeriodStartIsOpen"
                                        (closed)="uiState.popupPeriodStartIsOpen = false"
                                        disabled="false">
                                    </mat-datepicker>

                                    <span
                                        class="tooltip-content tooltip-content--show"
                                        style="margin-left:1.5cm"
                                        *ngIf="invalidField(['popupDto', 'periodStart'], 'required')">
                                        Notification Period Start must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label class="required">Notification Period End</label>

                                <label
                                    for="periodEnd"
                                    aria-haspopup="true"
                                    role="tooltip"
                                    class="tooltip tooltip-validation tooltip-md"
                                    [class.invalid]="invalidField(['popupDto', 'periodEnd'])">

                                    <input
                                        id="periodEnd"
                                        type="text"
                                        (click)="uiState.popupPeriodEndIsOpen = true"
                                        [matDatepicker]="domPopupPeriodEnd"
                                        [min]="popupForm?.get('periodStart')?.value"
                                        onkeydown="return false"
                                        placeholder="DD-MMM-YYYY"
                                        formControlName="periodEnd"/>

                                    <button type="button"
                                            class="btn btn-icon btn-link"
                                            *ngIf="!!popupForm?.get('periodEnd')?.value && popupForm?.get('periodEnd')?.enabled"
                                            (click)="resetPopupCalendar('periodEnd')">

                                        <clr-icon shape="times"></clr-icon>

                                    </button>

                                    <mat-datepicker
                                        #domPopupPeriodEnd
                                        [opened]="uiState?.popupPeriodEndIsOpen"
                                        (closed)="uiState.popupPeriodEndIsOpen = false"
                                        disabled="false">
                                    </mat-datepicker>

                                    <span
                                        class="tooltip-content tooltip-content--show"
                                        style="margin-left:1.5cm"
                                        *ngIf="invalidField(['popupDto', 'periodEnd'], 'required')">
                                        Notification Period End must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label [class.required]="popupForm?.get('idLinkedMenu')?.validator">Linked to
                                    Menu</label>

                                <label
                                    for="linkMenuSelect"
                                    aria-haspopup="true"
                                    role="tooltip"
                                    class="tooltip tooltip-validation tooltip-md"
                                    [class.invalid]="invalidField(['popupDto', 'idLinkedMenu'])">

                                    <span class="select">

                                        <select id="linkMenuSelect"
                                                [formControlName]="'idLinkedMenu'">

                                            <option *ngFor="let link of formOptions?.linkMenu"
                                                    [value]="link?.id">
                                                {{link?.detailCode | titlecase}}
                                            </option>

                                        </select>

                                    </span>

                                    <span class="tooltip-content"
                                          *ngIf="invalidField(['popupDto', 'idLinkedMenu'], 'required')">
                                        Linked to Menu must be filled
                                    </span>

                                </label>

                            </div>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">

                            <div class="form-group">

                                <label [class.required]="popupForm?.get('title')?.validator">
                                    Title
                                </label>

                                <label for="popupTitle"
                                       aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField(['popupDto', 'title'])">

                                    <input size="55"
                                           type="text"
                                           id="popupTitle"
                                           placeholder="Title"
                                           [attr.list]="popupTitleDatalist"
                                           formControlName="title"
                                           (blur)="checkPopUpTemplate($event)"/>

                                    <span *ngIf="invalidField(['popupDto', 'title'], 'required')"
                                          class="tooltip-content">
                                        Title must be filled
                                    </span>

                                    <datalist id="popUpTitleSelection">

                                        <option
                                            *ngFor="let title of suggestions?.popupTitles; trackBy: ngForTracker"
                                            [value]="title?.title || title['templateName']">
                                            {{title?.title || title['templateName']}}
                                        </option>

                                    </datalist>

                                </label>

                            </div>

                        </div>

                    </div>

                </section>

                <hr/>

                <section class="form-block">

                    <label>Receiver</label>

                    <div class="form-group">

                        <label class="required">Content Receiver</label>
                        <label for="contentReceiverTypeSelect"
                               aria-haspopup="true"
                               role="tooltip"
                               class="tooltip tooltip-validation tooltip-md"
                               [class.invalid]="invalidField('contentReceiverType')">
                                    <span class="tooltip-content">
                                        Content Receiver must be filled
                                    </span>

                            <span class="select">
                                        <select id="contentReceiverTypeSelect"
                                                [formControlName]="'contentReceiverType'">
                                            <option *ngFor="let receiver of formOptions?.contentReceivers"
                                                    [value]="receiver?.value">
                                                {{receiver?.label}}
                                            </option>
                                        </select>
                                    </span>
                        </label>
                    </div>

                    <ng-template [ngIf]="contentForm?.get('contentReceiverType')?.value === 'PRIVATE'">

                        <div class="row">

                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-6">

                                <div class="form-group">

                                    <label class="required">Upload File (*.xls)</label>

                                    <label for="receiverFile"
                                           aria-haspopup="true"
                                           role="tooltip"
                                           class="tooltip tooltip-validation tooltip-md"
                                           [class.invalid]="invalidField('uploadId')">

                                        <input type="file"
                                               id="receiverFile"
                                               multiple="multiple"
                                               size="50"
                                               accept="application/vnd.ms-excel"
                                               (change)="selectReceiverFile($event)"/>

                                        <span class="tooltip-content tooltip-content--show"
                                              *ngIf="invalidField('receiverFile', 'required')">
                                            Upload File must be filled
                                        </span>

                                        <span
                                            class="tooltip-content tooltip-content--show"
                                            *ngIf="invalidField('uploadId', 'fileTypes')">
                                                Format file invalid
                                        </span>

                                    </label>

                                </div>

                            </div>

                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-6"
                                 style="text-align: right;">

                                <button
                                    class="btn btn-outline"
                                    (click)="downloadReceiverTemplate($event)"
                                    [clrLoading]="uiState?.templateIsDownloading">
                                    <clr-icon shape="download"></clr-icon>
                                    Download Template
                                </button>

                            </div>

                        </div>

                        <button type="button"
                                class="btn btn-primary"
                                style="width: fit-content;"
                                (click)="processReceiverFile($event)"
                                [clrLoading]="uiState?.receiverIsProcessing">
                            Process
                        </button>

                        <button
                            *ngIf="receiverSummary?.countError > 0"
                            type="button"
                            class="btn btn-icon btn-warning"
                            style=""
                            (click)="downloadFailedReceiver($event)"
                            [clrLoading]="uiState?.failedRecordIsDownloading">
                            <clr-icon shape="warning-standard" class="is-solid"></clr-icon>
                            {{receiverSummary?.countError}} failed record(s)
                        </button>

                        <table class="table">
                            <tbody>
                            <tr>
                                <td width="50%"
                                    style="text-align: right;">Total Success Record
                                </td>
                                <td width="50%"
                                    style="text-align: left;">{{receiverSummary?.countSuccess || 0}} Row(s)
                                </td>
                            </tr>
                            <tr>
                                <td width="50%"
                                    style="text-align: right;">Total Failed Record
                                </td>
                                <td width="50%"
                                    style="text-align: left;">{{receiverSummary?.countError || 0}} Row(s)
                                </td>
                            </tr>
                            </tbody>
                        </table>

                        <br/>

                        <clr-datagrid>
                            <clr-dg-column>Company</clr-dg-column>
                            <clr-dg-column>People Type</clr-dg-column>
                            <clr-dg-column>Branch</clr-dg-column>
                            <clr-dg-column>Organization</clr-dg-column>
                            <clr-dg-column>Job Group</clr-dg-column>
                            <clr-dg-column>Job</clr-dg-column>
                            <clr-dg-column>Username</clr-dg-column>

                            <clr-dg-placeholder>No data!</clr-dg-placeholder>

                            <clr-dg-row *clrDgItems="let item of receiverSummary?.successItems">
                                <clr-dg-cell>{{item?.company || '-'}}</clr-dg-cell>
                                <clr-dg-cell>{{item?.peopleType || '-'}}</clr-dg-cell>
                                <clr-dg-cell>{{item?.branch || '-'}}</clr-dg-cell>
                                <clr-dg-cell>{{item?.organization || '-'}}</clr-dg-cell>
                                <clr-dg-cell>{{item?.jobGroup || '-'}}</clr-dg-cell>
                                <clr-dg-cell>{{item?.job || '-'}}</clr-dg-cell>
                                <clr-dg-cell>{{item?.username || '-'}}</clr-dg-cell>
                            </clr-dg-row>

                            <clr-dg-footer>
                                <ng-template [ngIf]="pagination?.totalItems > 0">
                                    {{+pagination?.firstItem + 1}}
                                    -
                                    {{+pagination?.lastItem + 1}}
                                    of
                                </ng-template>

                                {{pagination?.totalItems}}
                                errors

                                <clr-dg-pagination #pagination
                                                   [clrDgPageSize]="20"></clr-dg-pagination>
                            </clr-dg-footer>
                        </clr-datagrid>

                    </ng-template>

                </section>

                <hr/>

                <section class="form-block">
                    <label>Notification</label>

                    <div class="form-group">
                        <label>Send via</label>

                        <div class="row">
                            <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <clr-checkbox [formControlName]="'viaPushNotification'">
                                    Push Notification
                                </clr-checkbox>
                            </div>

                            <div class="col-xl-6 col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <label for="publishDate"
                                       aria-haspopup="true"
                                       role="tooltip"
                                       class="tooltip tooltip-validation tooltip-md"
                                       [class.invalid]="invalidField('publishDate')">
                                    <input type="text"
                                           id="publishDate"
                                           (click)="$event.preventDefault(); uiState.publishDateIsOpen = true;"
                                           [matDatepicker]="domPublishDate"
                                           [min]="contentLookup?.minPublishDate"
                                           onkeydown="return false"
                                           placeholder="Publish date (DD-MMM-YYYY)"
                                           formControlName="publishDate"/>

                                    <mat-datepicker #domPublishDate
                                                    [opened]="uiState?.publishDateIsOpen"
                                                    (closed)="uiState.publishDateIsOpen = false;"
                                                    disabled="false">
                                    </mat-datepicker>

                                    <span class="tooltip-content tooltip-content--show"
                                          style="margin-left:1.5cm"
                                          *ngIf="invalidField('publishDate', 'required')">
                                        Publish date must be filled
                                    </span>
                                </label>
                            </div>

                        </div>

                        <clr-checkbox [formControlName]="'viaEmail'">
                            E-mail
                        </clr-checkbox>
                    </div>
                </section>

                <div class="btn-group btn-primary btn-right">

                    <button type="submit"
                            class="btn btn-icon"
                            [clrLoading]="uiState?.isSaving">

                        <clr-icon shape="floppy"></clr-icon>

                        Save

                    </button>

                    <button type="button"
                            class="btn btn-icon btn-danger"
                            (click)="checkDeleteValidity($event)"
                            [clrLoading]="uiState?.isDeleting">

                        <clr-icon shape="trash"></clr-icon>

                        Delete

                    </button>

                    <button type="button"
                            class="btn btn-icon"
                            (click)="$event.preventDefault(); this.uiState.cancelModalIsOpen = true;">

                        <clr-icon shape="undo"></clr-icon>

                        Cancel

                    </button>

                </div>

            </form>

            <fema-cms-modal-cancel [(isOpen)]="uiState.cancelModalIsOpen"
                                   [returnLink]="'/content/search'"></fema-cms-modal-cancel>

            <fema-cms-modal-delete [(isOpen)]="uiState.deleteModalIsOpen"
                                   (delete)="delete()"
                                   [(isOpenSuccess)]="uiState.deleteSuccessModalIsOpen"
                                   [returnLink]="'/content/search'"></fema-cms-modal-delete>

            <fema-cms-modal-save [(isOpen)]="uiState.saveModalIsOpen"
                                 (save)="save()"
                                 [(isOpenSuccess)]="uiState.saveSuccessModalIsOpen"
                                 [returnLink]="'/content/search'"></fema-cms-modal-save>

        </main>

    </div>

</clr-main-container>
